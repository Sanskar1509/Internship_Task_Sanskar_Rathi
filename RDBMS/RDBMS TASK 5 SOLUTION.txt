								TASKS

1. Retrieve the names and locations of restaurants with a rating of 4.5 or higher.

	SELECT Name, City 
	FROM Restaurants 
	WHERE Rating >= 4.5;

2. Find the total number of orders placed by each customer.

	SELECT CONCAT(c.FirstName ,' ',c.LastName) AS CustomerName, 
	       COUNT(o.OrderID) AS TotalOrders
	FROM Customers c
	LEFT JOIN Orders o ON c.CustomerID = o.CustomerID
	GROUP BY c.CustomerID;

3. List all restaurants offering "Italian" cuisine in "Mumbai".

	SELECT Name, City 
	FROM Restaurants 
	WHERE CuisineType = 'Italian' AND City = 'Mumbai';

4. Calculate the total revenue generated by each restaurant from completed orders.

	SELECT Restaurants.Name AS RestaurantName, 
	       SUM(Orders.OrderAmount) AS TotalRevenue
	FROM Restaurants
	JOIN Orders ON Restaurants.RestaurantID = Orders.RestaurantID
	WHERE Orders.OrderStatus = 'Delivered'
	GROUP BY Restaurants.RestaurantID;

5. Retrieve the most recent order placed by each customer.

	SELECT Customers.FirstName || ' ' || Customers.LastName AS CustomerName, 
	       MAX(Orders.OrderDate) AS MostRecentOrder
	FROM Customers
	LEFT JOIN Orders ON Customers.CustomerID = Orders.CustomerID
	GROUP BY Customers.CustomerID;

6. List customers who have not placed any orders yet.
	
	SELECT concat(FirstName ,' ', LastName) AS CustomerName
	FROM Customers
	WHERE CustomerID NOT IN (SELECT DISTINCT CustomerID FROM Orders);

7. Identify the most reviewed restaurants.

	SELECT Restaurants.Name AS RestaurantName, 
	       COUNT(Reviews.ReviewID) AS TotalReviews
	FROM Restaurants
	JOIN Reviews ON Restaurants.RestaurantID = Reviews.RestaurantID
	GROUP BY Restaurants.RestaurantID
	ORDER BY TotalReviews DESC
	LIMIT 1;

8. Find the most preferred payment method.

	SELECT PaymentMethod, COUNT(PaymentID) AS TotalPayments
	FROM Payments
	GROUP BY PaymentMethod
	ORDER BY TotalPayments DESC
	LIMIT 1;

9. List the top 5 restaurants by total revenue.

	SELECT Restaurants.Name AS RestaurantName, 
	       SUM(Orders.OrderAmount) AS TotalRevenue
	FROM Restaurants
	JOIN Orders ON Restaurants.RestaurantID = Orders.RestaurantID
	WHERE Orders.OrderStatus = 'Delivered'
	GROUP BY Restaurants.RestaurantID
	ORDER BY TotalRevenue DESC
	LIMIT 5;

10. Show the details of all cancelled orders along with the customer's and restaurant's names.

	SELECT Orders.OrderID, 
	       concat(Customers.FirstName ,' ' , Customers.LastName) AS CustomerName,
	       Restaurants.Name AS RestaurantName, 
	       Orders.OrderAmount, Orders.OrderDate
	FROM Orders
	JOIN Customers ON Orders.CustomerID = Customers.CustomerID
	JOIN Restaurants ON Orders.RestaurantID = Restaurants.RestaurantID
	WHERE Orders.OrderStatus = 'Cancelled';
